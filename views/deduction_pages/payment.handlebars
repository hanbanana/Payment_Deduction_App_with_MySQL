<div style="margin-left: 200px; margin-right: 200px; font-size: 13px">
    <br>
    <h5>Add Weekly Payment</h5>
    <br>

    {{!-- On One Line Form- --}}
    <div class="formDiv" style="width: 1200px">

        <form id="createplan">
            <div class="form-group-sm row" style="column-gap: 5px;">
                <h6>Truck Payment</h6>
            </div>
            <div class="form-group-sm row" style="column-gap: 5px;">
                 {{#each truckPaymentData}}
                <span>
                   
                    <label for="ex1">Truck NO</label>
                    <input class="form-control form-control-sm" placeholder="truckNo" name="truckNo" id="truckNo"
                        value="{{this.truckNo}}" style="width: 200px" disabled>

                </span>
                <br>
                <span>
                    <label for="ex2">Owner No</label>
                    <input class="form-control form-control-sm" placeholder="ownerId" name="ownerId" id="ownerId"
                        value="{{this.ownerId}}" style="width: 200px" disabled>
                </span>
                <br>
                <br>
                <span>
                    <label for="ex1">Owner Name</label>
                    <input class="form-control form-control-sm" placeholder="ownerName" name="ownerName" id="ownerName"
                        value="{{this.ownerName}}" style="width: 200px" disabled>
                </span>
                <br>
                <span>
                    <label for="ex2">Driver No</label>
                    <input class="form-control form-control-sm" placeholder="driverId" name="driverId" id="driverId"
                        value="{{this.driverId}}" style="width: 200px" disabled>
                </span>
                <br>
                <span>
                    <label for="ex2">Driver Name</label>
                    <input class="form-control form-control-sm" placeholder="driverName" name="driverName"
                        id="driverName" value="{{this.driverName}}" style="width: 200px" disabled>
                </span>
                <br>
                {{/each}}
            </div>
            <br>

            <div class="form-group-sm row" style="column-gap: 5px;">
                {{#each truckPaymentData}}
                <span>
                    <label for="ex2">Incomet</label>
                    <input class="form-control form-control-sm" placeholder="truckTotalAmount" name="truckTotalAmount"
                        id="truckTotalAmount" type="text" value="{{this.input_truck_payment_truck_total_amount}}"
                        maxlength="45" disabled style="width: 200px">
                </span>
                <br>
                <span>
                    <label for="ex1">Truck Payment</label>
                    <input class="form-control form-control-sm" placeholder="downPayment" name="downPayment"
                        id="downPayment" type="text" value="{{this.input_truck_payment_down_payment}}" maxlength="45"
                        disabled style="width: 200px">
                </span>
                <br>
                <span>
                    <label for="ex1">Total Amount</label>
                    <input class="form-control form-control-sm" placeholder="payMonth" name="payMonth" id="payMonth"
                        type="text" value="{{this.totalAmount}}" maxlength="45" disabled
                        style="width: 200px">
                </span>
                <br>
                <span>
                    <label for="ex2">Paid Amount</label>
                    <input class="form-control form-control-sm" placeholder="paidAmount" name="paidAmount"
                        id="paidAmount" type="text" value="{{this.paidAmount}}" maxlength="200px"
                        disabled style="width: 200px">
                </span>
                <br>
                <span>
                    <label for="ex1">Balance Amount</label>
                    <input class="form-control form-control-sm" placeholder="balanceAmount" name="balanceAmount"
                        id="balanceAmount" type="text" value="{{this.balanceAmount}}"
                        maxlength="200px" disabled style="width: 200px">
                </span>
                <br>
                {{/each}}
            </div>
            <br>
            <div class="form-group-sm row" style="column-gap: 5px;">
                {{#each truckPaymentData}}
                <span>
                    <label for="ex1">This Time Payment</label>
                    <input class="form-control form-control-sm" placeholder="balanceAmount" name="balanceAmount"
                        id="balanceAmount" type="text" value="{{this.payWeek}}"
                        maxlength="200px" disabled style="width: 200px">
                </span>
                <br>
                {{/each}}
            </div>
            <br>
            <br>
            <br>

            <div class="form-group-sm row" style="column-gap: 5px;">
                <h6>Part Payment</h6>
            </div>
            <div class="form-group-sm row" style="column-gap: 5px;">
                {{#each servicePaymentData}}
                <span>
                    <label for="ex1">Truck NO</label>
                    <input class="form-control form-control-sm" placeholder="truckNo" name="truckNo" id="truckNo"
                        value="{{this.truckNo}}" style="width: 200px" disabled>
                </span>
                <br>
                <span>
                    <label for="ex2">Owner No</label>
                    <input class="form-control form-control-sm" placeholder="ownerId" name="ownerId" id="ownerId"
                        value="{{this.ownerId}}" style="width: 200px" disabled>
                </span>
                <br>
                <span>
                    <label for="ex2">Driver No</label>
                    <input class="form-control form-control-sm" placeholder="driverId" name="driverId" id="driverId"
                        value="{{this.driverId}}" style="width: 200px" disabled>
                </span>
                <br>
                <span>
                    <label for="ex2">Driver Name</label>
                    <input class="form-control form-control-sm" placeholder="driverName" name="driverName"
                        id="driverName" value="{{this.driverName}}" style="width: 200px" disabled>
                </span>
                <br>
                {{/each}}
            </div>
            <br>

            <div class="form-group-sm row" style="column-gap: 5px;">
                {{#each servicePaymentData}}
                <span>
                    <label for="ex2">Invoice No</label>
                    <input class="form-control form-control-sm" placeholder="Invoice No" name="invoiceNo"
                        id="invoiceNo" type="text" value="{{this.invoiceNo}}"
                        maxlength="45" disabled style="width: 200px">
                </span>
                <br>
                <span>
                    <label for="ex1">Total Amount</label>
                    <input class="form-control form-control-sm" placeholder="Total Amount" name="Amount"
                        id="Amount" type="text" value="{{this.totalAmount}}" maxlength="45"
                        disabled style="width: 200px">
                </span>
                <br>
                <span>
                    <label for="ex1">Pay/week</label>
                    <input class="form-control form-control-sm" placeholder="payWeek" name="payWeek" id="payWeek"
                        type="text" value="{{this.payWeek}}" maxlength="45" disabled
                        style="width: 200px">
                </span>
                <br>
                <span>
                    <label for="ex2">Sale Date</label>
                    <input class="form-control form-control-sm" placeholder="Date" name="Date"
                        id="Date" type="text" value="{{this.saleDate}}" maxlength="200px"
                        disabled style="width: 200px">
                </span>
                <br>
                <span>
                    <label for="ex1">CR</label>
                    <input class="form-control form-control-sm" placeholder="CR" name="CR"
                        id="CR" type="text" value="{{this.cr}}"
                        maxlength="200px" disabled style="width: 200px">
                </span>
                <br>
                {{/each}}
            </div>
            <br>
            <div class="form-group-sm row" style="column-gap: 5px;">
                {{#each servicePaymentData}}
                <span>
                    <label for="ex1">Invoice</label>
                    <input class="form-control form-control-sm" placeholder="Invoice" name="Invoice"
                        id="Invoice" type="text" value="{{this.invoice}}"
                        maxlength="200px" disabled style="width: 200px">
                </span>
                <br>
                                <span>
                    <label for="ex1">DESC</label>
                    <input class="form-control form-control-sm" placeholder="DESC" name="DESC"
                        id="DESC" type="text" value="{{this.desc1}}"
                        maxlength="200px" disabled style="width: 200px">
                </span>
                <br>
                {{/each}}
            </div>
            <br>

            <div class="form-group-sm row" style="column-gap: 5px;">
             
                {{!-- <button class="btn btn-secondary btn-sm" style="margin-top: 25px"
                        onclick="window.history.back()">Cancel</button> --}}
                <button class="btn btn-secondary btn-sm" id="cancelButton" style="margin-top: 25px">Cancel</button>

                <button type="submit" class="btn btn-secondary btn-sm" style="margin-top: 25px">Save</button>
            </div>


    </div>
    </form>

    {{!-- <button class="btn btn-secondary btn-sm" style="margin-top: 25px"
        onclick="window.location.href='/master_division'">Cancel</button> --}}

    <br>

</div>

</div>
<br>

<script type="text/javascript">


    $("#createplan").on("submit", function (event) {
        // Make sure to preventDefault on a submit event.
        event.preventDefault();

        var truck_total_amount = Number($("#truckTotalAmount").val());
        var down_payment = Number($("#downPayment").val());
        var pay_per_month = Number($("#payMonth").val());
        var paid_amount = Number($("#paidAmount").val());
        var this_time_payment = Number($("#thisTimePayment").val());
        var balance_amount = Number($("#balanceAmount").val());

        var result_balance_amount = balance_amount - this_time_payment;
        var result_balance_amount2 = result_balance_amount.toFixed(2);

        var result_total_paid_balance_amount = paid_amount + this_time_payment;
        var result_total_paid_balance_amount2 = result_total_paid_balance_amount.toFixed(2);

        $("#newBalanceAmount").html(result_balance_amount2);

        var newPlan = {
            input_truck_payment_truck_no: $("#truckNo").val().trim(),
            input_truck_payment_owner_id: $("#ownerId").val().trim(),
            input_truck_payment_owner_name: $("#ownerName").val().trim(),
            input_truck_payment_driver_id: $("#driverId").val().trim(),
            input_truck_payment_driver_name: $("#driverName").val().trim(),
            input_truck_payment_truck_total_amount: $("#truckTotalAmount").val().trim(),
            input_truck_payment_down_payment: $("#downPayment").val().trim(),
            input_truck_payment_sale_date: $("#saleDate").val().trim(),
            input_truck_payment_pay_month: $("#payMonth").val().trim(),
            input_truck_payment_paid_amount: result_total_paid_balance_amount2,
            input_truck_payment_this_time_payment: $("#thisTimePayment").val().trim(),
            input_truck_payment_paid_date: $("#paidDate").val().trim(),
            input_truck_payment_balance_amount: $("#newBalanceAmount").text().trim(),
        };


        // Send the POST request.
        $.ajax("/input_truck_payment_list", {
            type: "POST",
            data: newPlan
        }).then(
            function () {
                console.log("created new plan");
                // Reload the page to get the updated list
                location.assign("/deduction_search_truck");
            }
        );


    });

    // Cancel Button
    $("#cancelButton").on("click", function () {
        event.preventDefault();
        location.assign("/deduction_search_truck");
    });


    // Calculate
    var truck_total_amount = 0;
    var down_payment = 0;
    var pay_per_month = 0;
    var paid_amount = 0;
    var balance_amount = 0;

    var result_balance_Amaount = 0;

    $("#newBalanceAmount").on("click", function () {
        event.preventDefault();

        calculate();
        function calculate() {

            var truck_total_amount = Number($("#truckTotalAmount").val());
            var down_payment = Number($("#downPayment").val());
            var pay_per_month = Number($("#payMonth").val());
            var paid_amount = Number($("#paidAmount").val());
            var this_time_payment = Number($("#thisTimePayment").val());
            var balance_amount = Number($("#balanceAmount").val());

            var result_balance_amount = balance_amount - this_time_payment;
            var result_balance_amount2 = result_balance_amount.toFixed(2);
            $("#newBalanceAmount").html(result_balance_amount2);


            // result_totalCostToAmazon = (supplier_price * order_quantity) + ship_to_us_or_amazon + ship_to_amazon + upc_code + upc_sticker;
            // result_amazonFbmFee = amazon_fee + fba_fee;
            // result_netProfitFromAmazon = price_on_amazon - amazon_fee - fba_fee;
            // result_finalPurchasingItemPrice = result_totalCostToAmazon / order_quantity;
            // result_finalPurchasingListingPrice = item_quantity_on_listing * (result_totalCostToAmazon / order_quantity);
            // result_finalProfit = price_on_amazon - amazon_fee - fba_fee - result_finalPurchasingListingPrice;
            // result_shipUs = (supplier_price * order_quantity) * 0.6;
            // result_shipAmazon = (supplier_price * order_quantity) * 0.4;
            // result_shipCostEachItem


            console.log(result_balance_Amaount);
        };
    });


</script>